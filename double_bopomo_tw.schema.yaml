# Rime schema
# encoding: utf-8

schema:
  schema_id: double_bopomo_tw
  name: "雙碼注音．臺灣"
  version: "0.1"
  author:
    - imper0502 <yoj845@gmail.com>
  description: |  
    雙碼注音．臺灣（注音詞庫，非漢語拼音詞庫）

switches:
  - name: ascii_mode
    reset: 0
    states: [ "中", "En" ]
  - name: full_shape
    reset: 0
    states: [ "半形", "全形" ]
  - name: ascii_punct
    reset: 0
    states: [ "。，", "．，" ]
  - name: tw2t
    reset: 0
    states: [ "教部標準", "傳承正體" ]  # OpenCC 標準

engine:
  processors:
    - key_binder
    - ascii_composer
    - recognizer
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - echo_translator
    - punct_translator
    - script_translator
  filters:
    - cjk_minifier     # 過濾少用字
    - simplifier@tw2t  # 簡繁轉換
    - uniquifier       # 過濾重複的候選字，有可能來自簡正繁轉換

tw2t: # 正繁轉換
  option_name: tw2t
  opencc_config: tw2t.json
  tips: none

menu:
  alternative_select_keys: 67890
 
speller:
  alphabet: "bpmfdtnlgkhjqxvwarzcsiuyoeIUYAOEQHWSRKDJFL12345"
  finals: "12345"
  delimiter: " '"
  # ㄅㄆㄇㄈ  bpmf
  # ㄉㄊㄋㄌ  dtnl
  # ㄍㄎㄏ    gkh 
  # ㄐㄑㄒ    jqx
  # ㄓㄔㄕㄖ  avor
  # ㄗㄘ厶    zcs/wcs
  # ㄧㄨㄩ（聲） iuy
  # ㄧㄨㄩ（韻） IUY
  # ㄚㄛㄜㄝ　   AOEQ
  # ㄞㄟㄠㄡ　   HWSR
  # ㄢㄣㄤㄥ　   KDJF
  # ㄦˉˊˇˋ˙      L12345
  algebra:
    - xlit/ˉˊˇˋ˙/12345/
    - xlit/ㄅㄆㄇㄈㄉㄊㄋㄌㄍㄎㄏㄐㄑㄒㄓㄔㄕㄖㄗㄘ厶/bpmfdtnlgkhjqxavorzcs/
    - derive/z/w/
    - xform/(^| )ㄧ(\d)/$1iI$2/
    - xform/(^| )ㄨ(\d)/$1uU$2/
    - xform/(^| )ㄩ(\d)/$1yY$2/
    - xform/(^| )ㄧ/$1i/
    - xform/(^| )ㄨ/$1u/
    - xform/(^| )ㄩ/$1y/
    - xform/([a-z])ㄧ/$1I/
    - xform/([a-z])ㄨ/$1U/
    - xform/([a-z])ㄩ/$1Y/
    - xlit/ㄚㄛㄜㄝㄞㄟㄠㄡㄢㄣㄤㄥㄦ/AOEQHWSRKDJFL/
    - xform/(^| )([AOEQHWSRKDJFL]\d)/$1e$2/
    - derive/(^| )i(I\d)/$1e$2/
    - derive/(^| )u(U\d)/$1e$2/
    - derive/(^| )y(Y\d)/$1e$2/
    - derive/(^| )([eiy])Q(\d)/$1$2E$3/
    
    # 到此，注音被轉換為小寫（聲母）、大寫（韻母）、數字（聲調）；空韻😬/I/先不轉換
    ## ㄚㄛㄜㄝ　   AOEQ
    - xform/[IU]A/x/
    - xform/UO/o/
    - xform/IQ/p/
    - xform/YQ/q/
    ## ㄞㄟㄠㄡ　   HWSR
    - xform/(UH|IF)/g/
    - xform/(UW|ID)/v/
    - xform/IS/n/
    - xform/IR/b/
    ## ㄢㄣㄤㄥ　   KDJF
    - derive/Y([KDF])/$1/
    - xform/IK/m/
    - xform/[UY]K/t/
    - xform/[UY]D/z/
    - xform/[IU]J/c/
    - xform/[UY]F/l/
    # 到此，基本指法完成，接下來加入進階指法。（或是大寫轉小寫；xform/😬/I/）
    ## [iuy] + [IUY][AOEQHWSRKDJFL] = [iuy] + [AOEQHWSRKDJFL]——影響簡拼，還是不加好了。
    ##
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    - derive/
    
    - fuzz/([a-z])[a-z]\d/$1/
    - fuzz/([a-z])[a-z](\d)/$1$2/
    - fuzz/ea\d/A/
    - fuzz/eo\d/O/
    - fuzz/ee\d/E/
    - fuzz/eq\d/Q/
    - fuzz/eh\d/H/
    - fuzz/ew\d/W/
    - fuzz/es\d/S/
    - fuzz/er\d/R/
    - fuzz/ek\d/K/
    - fuzz/ed\d/D/
    - fuzz/ej\d/J/
    - fuzz/ef\d/F/
    - fuzz/el\d/L/
    - fuzz/ea(\d)/A$1/
    - fuzz/eo(\d)/O$1/
    - fuzz/ee(\d)/E$1/
    - fuzz/eq(\d)/Q$1/
    - fuzz/eh(\d)/H$1/
    - fuzz/ew(\d)/W$1/
    - fuzz/es(\d)/S$1/
    - fuzz/er(\d)/R$1/
    - fuzz/ek(\d)/K$1/
    - fuzz/ed(\d)/D$1/
    - fuzz/ej(\d)/J$1/
    - fuzz/ef(\d)/F$1/
    - fuzz/el(\d)/L$1/

translator:
  enable_charset_filter: true
  strict_spelling: true
  dictionary: double_bopomo_tw
  prism: double_bopomo_tw
  # preedit_format:
    # - xlit/bpmfdtnlgkhjqxavorzwcseiuy/ㄅㄆㄇㄈㄉㄊㄋㄌㄍㄎㄏㄐㄑㄒㄓㄔㄕㄖㄗㄗㄘ厶◌ㄧㄨㄩ/
    # - xlit/IUYAOEQHWSRKDJFL12345/ㄧㄨㄩㄚㄛㄜㄝㄞㄟㄠㄡㄢㄣㄤㄥㄦˉˊˇˋ˙/ 

punctuator:
  import_preset: symbols

key_binder:
  import_preset: default

recognizer:
  import_preset: default
  patterns:
    punct: "^/([0-9]0?|[A-Za-z]+)$"
    url: "^(www[.]|https?:|ftp:|mailto:).*$"
